const MINIMUM_KEY_LENGTH = 1;
const MAXIMUM_KEY_LENGTH = 13;
const cipherText = "F96DE8C227A259C87EE1DA2AED57C93FE5DA36ED4EC87EF2C63AAE5B9A7EFFD673BE4ACF7BE8923CAB1ECE7AF2DA3DA44FCF7AE29235A24C963FF0DF3CA3599A70E5DA36BF1ECE77F8DC34BE129A6CF4D126BF5B9A7CFEDF3EB850D37CF0C63AA2509A76FF9227A55B9A6FE3D720A850D97AB1DD35ED5FCE6BF0D138A84CC931B1F121B44ECE70F6C032BD56C33FF9D320ED5CDF7AFF9226BE5BDE3FF7DD21ED56CF71F5C036A94D963FF8D473A351CE3FE5DA3CB84DDB71F5C17FED51DC3FE8D732BF4D963FF3C727ED4AC87EF5DB27A451D47EFD9230BF47CA6BFEC12ABE4ADF72E29224A84CDF3FF5D720A459D47AF59232A35A9A7AE7D33FB85FCE7AF5923AA31EDB3FF7D33ABF52C33FF0D673A551D93FFCD33DA35BC831B1F43CBF1EDF67F0DF23A15B963FE5DA36ED68D378F4DC36BF5B9A7AFFD121B44ECE76FEDC73BE5DD27AFCD773BA5FC93FE5DA3CB859D26BB1C63CED5CDF3FE2D730B84CDF3FF7DD21ED5ADF7CF0D636BE1EDB79E5D721ED57CE3FE6D320ED57D469F4DC27A85A963FF3C727ED49DF3FFFDD24ED55D470E69E73AC50DE3FE5DA3ABE1EDF67F4C030A44DDF3FF5D73EA250C96BE3D327A84D963FE5DA32B91ED36BB1D132A31ED87AB1D021A255DF71B1C436BF479A7AF0C13AA14794";

//const cipherText="FB8BCAC3CB8CC286DC97C6808F80CE978F8ADCC3CD86C38ACA95CA878F97C0C3C782D9868F86D98CC395CA878F85DD8CC2C3DB8BCAC3E186CE918FA6CE90DB86DD8D8F94C68FCB80CE9783C3D88BC090CAC3DD82C184CAC3CC8CD986DD908F95CE90DBC3DF8CDD97C68CC1908F8CC9C3DB8BCAC3E28ACB87C3868FA6CE90DBC3D886DC97D882DD878F97C0C3DB8BCAC3EE97C382C197C6808F80C082DC978F8CC9C3EE85DD8ACC8281B89DD1F2B89DD0F2C3ED86DB94CA86C1C398D383D39FD38F82C1878FD29FD383D39FD38F9ACA82DD908F82C88C8F97C7868F82C18AC282C3C3C882D9868F91C690CAC3DB8C8F97C7868F84CA8DCA97C6808F8FC68DCA82C8868F97C782DBC3CA95CA8DDB96CE8FC39A8F93DD8CCB96CC86CBC3CE8FC3C3CB8CC286DC97C680CE97CA878F80CE97DCCFF4D19BBE8F8BCE95C68DC8C3CB8AD986DD84CA878F85DD8CC2C3DB8BCAC3E186CE918FA6CE90DB86DD8D8F94C68FCB80CE978F82DD8CDA8DCBC397CF9FD39FC3EDA08F8AC1C3DB8BCAC3E28ACB87C3868FA6CE90DBCDF4D29DBEF4D29ABEA2B7C7868F85CA8FC687DCC3CE91CAC3CEC3DD82DF8ACB8FD6C3CA95C08FD98AC1848F85CE8EC68FD6C3C0858F8ECE8EC282C3908F97C782DBC3DC8BCE91CAC3CEC3CC8CC28EC08D8F82C180CA90DB8CDDC3C08DC39A8FD29F012F709ED68F8EC68FC38AC08D8F9ACA82DD908F82C88CF4D19ABE8F82C1878F8AC180C396CB868F8FC68CC19083C3DB8AC886DD9083C3CC8CDA84CE91DCC3CE8DCBC3C282C19A8F8CDB8BCA91DCCD8FB4C697C78AC1C3DB8BC6908F85CE8EC68FD6CF8F87C08ECA90DB8ACCC3CC82DB908FCBE986C38ADCC3CC82DB96DCCA8F82DD868F93CE91DBC3C0858F97C7868F84CA8DDA908FA5CA8FC69083C3D88BC680C7C3C6908F828F84DD8CDA938F8CC9C3DC8ECE8FC3C3CC82DB908F80C08DDB82C68DC68DC8C3CE81C096DBC3DC86D986C1C3DC93CA80C686DCC38787CA93CA8DCB8AC1848F96DF8CC1C3CC8FCE90DC8AC98ACC82DB8AC08D8F90CC8BCA8ECACA81B89EBEF4D199BE8FAECA8ECD86DD908F8CC9C3DB8BCAC3C886C196DCC3CE91CAC3C98CDA8DCBC3D88CDD8FCB94C687CAC3CE8DCBC3C68DCC8FDA87CAC3DB8BCAC3C596C184C3868F80CE978FCBE986C38ADCC3CC8BCE96DCCA8F8CC9C3DC8CDA97C786CE90DBC3EE90C68283C3EA96DD8CDF86CE8D8F94C68FCB80CE978FCBE9CD8F90C68FD986DC97DD8ADCC3DC8AC395CA90DB91C69086CF8FA2C991C680CE8D8F94C68FCB80CE978FCBE9CD8F9081C3C39ACD8ACC8286CF8F97C7868FA0C78AC186DC868F8EC096C197CE8AC1C3CC82DBC387A581C3CD8ACA97C6CA83C3CE8DCBC3DB8BCAC3EE91CE81C682C1C3DC82C1878F80CE978FCBE9CD8F8ECE91C882DD8ADB8286CF8F82C28CC1848F8CDB8BCA91DCCDF4D198BEA2B7C7868F87C08ECA90DB8ACCC3CC82DBC3D882DCC3C98ADD90DBC3CC8FCE90DC8AC98ACA878F82DCC3E986C38ADCC3CC82DB96DCC3CD9A8FA0CE91C3C3E38AC18DCE86DA908F8AC1C3DB8BCAC39ED3DB8B8F86CB8ADB8AC08D8F8CC9C3C78ADCC3FC9ADC97CA8ECEC3E182DB96DD82CAC3DF96CD8FC690C786CBC3C68D8FD298D697CDF4D2F2B89DBE8FA1CA80CE96DC868F8CC9C3C28CCB86DD8D8F93C79AC38CC886C186DB8ACC9083C3CB8CC286DC97C6808F80CE97DCC3CE91CAC3DA90DA82C38FD6C3DD86C882DD87CA878F82DCC3CE8DC097C786DDC3DC96CD90DF86CC8ACA908F8CC9C3DB8BCAC3D88AC387CC82DBCF8FA581C3DC8AC395CA90DB91C69081B89EBEF4D197BEF4D196BE8FB7C78ADCC3C782DCC3DD86DC96C397CA878F8AC1C3C28AD786CBC3DA90CE84CAC3C0858F97C7868F97CA91C29083C3CE908F97C7868F87C08ECA90DB8ACCC3CC82DBC3CC82C1C3CD868F80CE8FC386CBC3CD9A8F8ADB908F90DA81DC93CA80C686DCC3C182C28683C3E986C38ADCC3DC8AC395CA90DB91C6908F80CE97DA9081B89EBEF4D197BEF4D196BE8FB4C68FCB80CE97DCC3C782D9868F82C390C0C3CD86CA8D8F91CA85CA91DD86CBC3DB8C8F82DCC3D982DD8AC096DCC3DC96CD90DF86CC8ACA908F8CC9C3E9CD8F80CE97DA9083B89DDAF2C3CD96DBC3C68D8FD19FD39CCF8F97C7868FAAC197CA91C182DB8AC08DCE8F8FA0C08EC28ADC90C68CC1C3C08D8FB9C08CC38CC88ACC82C3C3E18CC286C180C382DB96DD868F85C69BCA878F97C7868F8DCE8ECAC3C98CDDC3D88AC387CC82DB908F82DCC3E9CD8F90C68FD986DC97DD8ADCCDF4D09FBE8FB7C7868F8EC090DBC3CC8CC28EC08D8F8DCE8ECAC3C68D8F96DC868F85C0918F97C7868F87C08ECA90DB8ACCC3CC82DBC3DD86C282C68DDCC3E9CD8F80CE97DA9081C3FC8CC286DB8AC286DCCF8F97C7868F87C08ECA90DB8ACCC3CC82DBC3C782DCC3CD86CA8D8F80CE8FC386CBC3E986C38ADCC3CB8CC286DC97C680DA90F4D09EBE8F82DCC3DF91C093C090CA878F81D6C3E886DD8ECE8D8F8DCE97DA91CE8FC690DBC3E5CDECCDFFCD8FA6DD9BC386CD86C1C3C68D8FD298D498CFF4D09DBE8F81DA978F97C786DC868F82DD868F8DC0978F95CE8FC6878F97CE9BC08DC08EC6808F8DCE8ECA908F82C1878F8BCE95CAC3CD86CA8D8F96DC86CBC3C08DC39A8F91CE91CA8FD6C3C68D8F90CC8ACA8DDB8AC98ACCC3C38ADB86DD82DB96DD8681B89CD0F2C3EEC3DF8CDF96C382DB8AC08D8F8CC9C3FB91CE8DDC80CE96CC82DC8ACE8D8F81C382CC888F85CA91CE8F8F80CE97DCC3D882DCC3C08DCC868F80C382DC90C685C686CBC3CE908FA5CA8FC6908F87CE86C28CC1C387B0CE97DA8DC68D8FD296D39BCA8F81DA978F8DC0948F97C78ADCC3DF8CDF96C382DB8AC08D8F8ADCC3CC8CC190C687CA91CA878F97C0C3CD868F828F93CE91DBC3C0858F87C08ECA90DB8ACCC3CC82DBCDF4D09BBEA2A2C38F8F97C7868F80CE97DCC3C68D8F97C78ADCC3C886C196DCC3DC8BCE91CAC3CEC3CC8CC28EC08D8F82C180CA90DB8CDDC3DB8BCE978F8ADCC3CD86C38ACA95CA878F97C0C3C782D9868F8FC695CA878F82DD8CDA8DCBC399012F7098C3C28AC38FC68CC1C3D686CE91DCC3CE84C0C3C68D8F97C7868FADCA82DDC3EA82DC978FCBDB8BCAC3E28ACB87C3868FA6CE90DBCA81B89CD6F2C3FB8BCAC3CA9BCE80DBC3DD86C382DB8AC08DDC8BC693DCC3D88ADB8BC68D8F97C7868FA5CA8FC687CE868F82DD868F80C38CDC868F81DA978F90DB8AC38F8F96C180CA91DB82C68D83B89CD5F2B89CD4F2C3CACDC8CD8F97C7868FA0C78AC186DC868F8EC096C197CE8AC1C3CC82DBC3C6908F90C08ECA97C68ECA908F80C382DC90C685C686CBC38796C187CA918F97C7868F8DCE8ECAC3E986C38ADCC3DC8AC395CA90DB91C6908F81C686DB8A86C3CE908F828F90DA81DC93CA80C686DCC3C0858F97C7868F94C68FCB80CE9783C3C38AC4868F97C7868FADC091DB8B8FA2C991C680CE8D8F95CE91C686DB9A8FA581C3DCCD8F8FD681C680CECDF4D197BEF4D099BEA2EEEE8DCC8ACA8DDBC3EA84D693DB8ACE8D8F90CC96C393DB96DD868F8CC9C3DB8BCAC3CC82DBC3C88CCB87CA90DCC3ED82DC97CA9781C3FB8BCAC3CA82DD8FC686DC978F86D98ACB86C180CAC3C0858F85CA8FC68DCA908F82DCC3EA84D693DB8ACE8D8F87CA8ADB8ACA908F80C08ECA908F85DD8CC2C3CEC3CCCD8FD09ED39FC3EDA081EEE68D8F80C08EDF82DD8ADC8CC1C3DB8C8F87C084DCCF8F80CE97DCC3C782D9868F8DC0978F96C187CA91C88CC1868F8ECE89C0918F80C782C184CA908F87DA91C68DC8C3DB8BCAC3CB8CC286DC97C680CE97C68CC1C3DF91C080CA90DCCF8F82DCC3DB8BCAC3C98CDD8E8F82C1878F81CA8BCE95C68CDDC3C0858F97C7868F87C08ECA90DB8ACCC3CC82DBC3C6908F8DC0978F91CE87C680CE8FC39A8F87C685C986DD86C1978F85DD8CC2C3DB8BC090CAC3C0858F94C68FCB80CE97DCC3CE8DCBC3CB8CC286DC97C6808F80CE97DCC3CE91CAC3DF86DD85CA80DB8FD6C3CC82DF82CD8FCAC3C0858F90DA91D98AD98AC1848F8AC1C3DB8BCAC3D88AC38781B89CDBF2B89CDAF2C3E996C38FD6C3CB8CC286DC97C680CE97CA878F8BC096DC868F80CE97DCC3C085DB86C1C3C68DDB86DD81DD86CA878F94C697C7C3C986DD82C3C3E9CD8F80CE97DA908F93C093DA8FCE97C68CC19083B89BD3F2C3DF91C087DA80C68DC8C3C79ACD91C687DCC3DC96CC8B8F82DCC3DB8BCAC3E486C38FCE908F80CE9781C3FB8BC6908F8FC68EC697CA878F86D98CC396DB8AC08D8F87DA91C68DC8C3CB8CC286DC97C680CE97C68CC1C3C286CE8DDCC3DB8BCE978F8BD681DD8ACB8ADC82DB8AC08D8F80CE8D8F8CCC80DA918F94C697C7C3C282C19A8F8CDB8BCA918F85CA8FC687DCCF8F8DC097CE81C39A8F97C7868FA2DC8ACE8D8F8FCA8CDF82DD878F80CE9781B89BD2F2C3FC86D986DD82C3C3C182DB96DD82C3C3CD86C782D98AC091DCC3CE8DCBC3CC8BCE91CE80DB86DD8ADC97C680DCC3C0858F94C68FCB80CE97DCC3C282D6C3C782D9868F93DD86CB8ADC93C090CA878F97C786C2C3C98CDDC3CB8CC286DC97C680CE97C68CC1C3CE908F93CA97DCCDF4D096BE8FB7C786DC868F97DD82C697DCC3C68DCC8FDA87CAC3DB8BCA8ADDC3DC8ECE8FC3C3DC8AD58683C3DC8CCC8ACE8F8F8DCE97DA91CACF8F8CCD95C68CDA908F81C087D6C3C382C184DA82C88683C3C38CD9868F8CC9C3DF8FCE9A8F82C1878F91CA8FCE97C695CA8FD6C3C78AC88B8F8AC197CA8FC38AC886C180CACDF4D79DBE95D29D012F709ED48FB0CA95CA91CE8F8F90C282C38F8F85CA8FC6878F90DF86CC8ACA908F8ECE9A8F8BCE95CAC3CE8D8F8AC181C091C1C3DB86C187CA8DCC9A8F97C094CE91CB908F97CE8ECA8DCA90DCCDF4D096BEA2A0CE97DCC3C782D9868F86C697C786DDC3CEC3C296DB96CE8FC690DB8ACCC3C0918F80C08EC286C190CE8F8F91CA8FCE97C68CC190C78ADFC3D88ADB8B8F8BDA8ECE8DDCCD8FB7D88C8F8ECE8AC1C3DB8BCA8CDD8ACA908F82DD868F84C695CA8D8F82CD8CDA978F8BC0948F80CE97DCC3D886DD868F87C08ECA90DB8ACC82DB86CBCD8FAAC1C3C08DCACF8F93CA8CDF8FCAC3CB86C38ACD86DD82DB86C39A8F97CE8ECA878F80CE97DCC3C68D8F828F93DD8CCC86DC908F8CC9C3CE91DB8AC98ACC8ACE8F8F90CA8FCA80DB8AC08D8F82DCC3DB8BCA9A8F94CA91CAC3DA90CA85DA8F8F93DD86CB82DB8CDD908F8CC9C3D986DD8EC68D81B89BD0F2C3FB8BC6908F8BCE908F81CA86C1C3CC91C697C680C699CA878F82DCC3C68EDF8FCE96DC8ACD8FCACF8F81CA80CE96DC868F97C7868F91CA94CE91CBC3C98CDDC3DC96CC8B8F82C1C3CA85C98CDD978F8ECE9A8F8BCE95CAC3CD86CA8D8F97C08C8F8FC697DB8FCAD88F80CE97DCC3C886C186DD82C38FD6C3CB8C8F8DC0978F80CE91DD9A8F8CDA978F80C08EC282C187DCC3CE8DCBC3CE8FDB8BC096C88B8F97C786D6C3CB8C8F86CE978F91C087CA8DDB9083C3C097C786DDC3DC93CA80C686DCC3DC96CC8B8F82DCC3C986DD91CA97DCC3C0918F97CA91DD8ACA91DCC3C282D6C3CD868F81CA97DB86DDC3CE978F80C08DDB91C08FC38AC1848F97C786DC868F93CA90DB9081B89DDBF2C3FB8BCAC3CE8FDB86DD8DCE97C695CAC3C687CA828F8ADCC3DB8BCE978F80CE97DCC3D886DD868F90C68EDF8FD6C3DB8CC386DD82DB86CBC3CD9A8F93CA8CDF8FCAC3CE8DCBC3C891CE87DA82C38FD6C3CB8AD986DD84CA878F85DD8CC2C3DB8BCA8ADDC3D88AC3878F91CA8FCE97C695CA908F97C791C096C88B8F8DCE97DA91CE8F8F90CA8FCA80DB8AC08D83C3CE908F97C786D6C3CE87CE93DB86CBC3DB8C8F8BDA8DDB8AC1848F97C7868F95CA91C28AC1C3C98CDA8DCBC3CE91C096C1878F8BDA8ECE8DDCC3C68D8F97C094C1908F82C1878F95C68FC382C886DCCDF4D197BE";

//const cipherText="FB8B9C6ACE168ACA908D23C95984CE97D923D95985CA8F902FDC1C838F97966AC21891CAC39C3CC51591CA87D92CD8168A8F97912F8A3782CE91D90FCB0A93CA91976ADD108BCB80983E865990C78C8A2F8A0B86C1849C6AC91691CA918A6ADC1894DBC38925D80D8EC08D8A6AC51FC7DB8B9C6AE71083CB8F9C6AEF1894DBC38E2FD90D90CE919D6ADE16C7DB8B9C6AEB0D8BCE8D8D23C95984C0828A3E8A16818FA29F38C31A8681B8CB78F722D59CBED908CF0D90CA86976A9D49CB9FD3C96ACB17838FD2C97A8649D79FC3802FCB0B948F829E258A0D8FCAC39824C31486C3C39E2BDC1CC7DD8A8A2F8A0D888F97912F8A1E82C1868D23C9598BC68D9C2BCD1CC7DB8B983E8A1C91CA8D8D3FCB158BD6C38938C51D92CC869D6ACB158B8F879627CF0A93C680983ECF1DC7CC828D398622D59BBED922CB0F8EC184D92EC30F82DD849C2E8A1F95C08ED93EC21CC7E18698388A3C86DC979C38C45990C68F9D29CB0DC7CE91963FC41DC797CFC97A9A59A5ECC390248A0D8FCAC3B423CE1D8BCAC3BC2BD90DC9F4D2CB17F148D2F2EEAD22CF5981CA8F902ED95986DD86D92B8A0B86DF8A9D26D35982D98C953CC317808F859827C3159E8F8C9F6AC7188AC28295398A0D8FCE97D939C21895CAC3986AC9168AC28C976ACB1784CA908D25D85988C18F806A9B49052F70C87F8A148EC38F9025C4599ECA828B398A1880C0B8CB7FF75986C187D923C41A8BDA879C6AC61088C190D56ADE1080CA918A668A1A88DA849838D95986C187D927CB179E8F8C8D22CF0B9481C3AE23DE118EC1C38D22C30AC7C9829423C600CB8F879627CF0A93C680D929CB0D948FCBBF2FC610948F80983EDF0ACE8F828B2F8A0986DD97D925CC5993C786D92DCF1792DCC3BF2FC6109483C38E22C31A8F8F8A8A6ACB5980DD8C8C3A8A16818F90942BC615C7CC828D398A1A88C1979823C41089C8C39828C50C938F909C3CCF17C7DC939C29C31C948FCB9D2FDA1C89CB8A972D8A0C97C08DD929C61894DC8A9F23C91893C68C976AD91A8FCA8E9C638422D6F2B8CB7CF759AACA8E9B2FD80AC7C085D93EC21CC7C886973FD95986DD86D92CC50C89CBC38E25D81583D88A9D2F8A1889CBC39024C91592CB86D93EC21CC7C596972DC61CC7CC828D6A823F82C38A8A6AC91186DA90D06AC51FC7DC8C8C3EC21C86DC97D90BD9108683C3BC3FD81697CA82976ADD108BCB80983E8A51A181C38A23C60F82DC978B23D95994C68F8F2FD90D95C690D0668A3881DD8A9A2BC45990C68F9D29CB0DC787A5D76AD957C7C39A9B23C918CE83C38D22CF59A4C78A972FD91CC7C28C8C24DE188EC1C39A2BDE59CFE9CDD928C31C93C6CAD56ACB17838F97912F8A3895CE81902BC45994CE8D9D6AC918938FCBBF648A1486DD849838C30D8686CFD92BC71689C8C3963EC21C95DCCDA2789D24EAFB8B9C6ACE168ACA908D23C95984CE97D93DCB0AC7C98A8B39DE5984C3828A39C31F8ECA87D92BD959A1CA8F90398A1A86DB968A6AC800C7EC828B268A358EC18D982FDF0AC7C68DD93EC21CC79ED38D228A1C83C6979025C45988C9C39123D959B4D6908D2FC718C7E1828D3FD818828F938C28C61094C7869D6AC317C79ED4CC728422D6F2B8CB178A3B82CC828C39CF5988C9C39425CE1C95C1C38922D31588C886972FDE1084DCCFD92EC51482DC9790298A1A86DB90D92BD81CC7DA908C2BC6159E8F919C2DCB0B83CA87D92BD95986C18C8D22CF0BC7DC969B39DA1C84C6868A6AC51FC7DB8B9C6ADD108BCB80983E8659A181C38A23C60F82DC978B23D957BC9EBEA2789224BC9DDAA46AFE118EDCC3912BD95995CA908C26DE1C838F8A976AC7109FCA87D93FD91880CAC3962C8A0D8FCAC38D2FD8149483C398398A0D8FCAC39D25C71C94DB8A9A6AC918938F8098248A1B828F809826C61C838F81806AC30D948F908C28D90982CC8A9C398A1786C286D56AEC1C8BC690D939C31591CA908D38C30AC7CC828D3FD957BC9EBEA2789224BC9DDAA46AFD108BCB80983ED9598FCE959C6ACB1594C0C39B2FCF17C7DD869F2FD80B82CBC38D258A18948F959838C31692DCC38A3FC80A97CA80902FD95988C9C3BF648A1A86DB968A66F14BDEF2C39B3FDE598EC1C3CB7A9A4ACB8F97912F8A3089DB868B24CB0D8EC08D98268A3A88C28E9039D91088C1C396248A2388C08F962DC31A86C3C3B725C71C89CC8F983EDF0B828F859032CF1DC7DB8B9C6AC4188ACAC39F25D85990C68F9D29CB0D948F828A6AEC57C7DC8A953CCF0A93DD8A8A64F14AD7F2C3AD22CF598AC0908D6AC9168AC28C976AC4188ACAC390248A0C94CAC39F25D85993C786D92EC51482DC9790298A1A86DBC38B2FC7188EC190D90C845984CE978C398459B4C08E9C3EC31482DCCFD93EC21CC7CB8C942FD90D8ECCC39A2BDE598FCE90D928CF1C898F809826C61C838FA59C26C30AC7CB8C942FD90D8ECC968A119948BA8F828A6ADA0B88DF8C8A2FCE5985D6C3BE2FD81486C1C3972BDE0C95CE8F9039DE59AD81A0D71A8459A2DD9B952FC81C898F8A976A9B4ED098CFA2799824C7CD968D6ADE1182DC86D92BD81CC7C18C8D6ADC188BC687D93ECB0188C18C9423C95989CE8E9C398A1889CBC3912BDC1CC7CD869C248A0C94CA87D925C4159E8F919838CF159E8F8A976AD91A8ECA8D8D23CC10848F8F903ECF0B86DB968B2F8422D49CBED90B8A0988DF96952BDE1088C1C3962C8A2D95CE8D8A29CB0C84CE90902BC45985C3829A218A1F82DD82956AC91893DCC38E2BD95988C1809C6AC91586DC90902CC31C838F828A6AEC1C8BC690D92ECB1C8AC08DD962F91893DA8D90248A48DE9FD7D06AC80C938F8D963D8A0D8FC690D93AC50992C3828D23C517C7C690D929C51794C6879C38CF1DC7DB8CD928CF59868F939838DE5988C9C39D25C71C94DB8A9A6AC9189381B8CA7EF774A6C38FD93EC21CC7CC828D398A10898F979123D95980CA8D8C398A0A8FCE919C6ACB5984C08E9425C45986C1809C39DE16958F97912BDE598EDCC39B2FC61082D9869D6ADE16C7C7828F2F8A158ED9869D6ACB0B88DA8D9D6A9C9B673CD4D927C3158BC68C976AD31C86DD90D92BCD16C7C68DD93EC21CC7E18698388A3C86DC97D962DE11828FAE902ECE15828FA69839DE50C9F4D0CC178A2D8FCAC39C32CB1A938F919C26CB0D8EC08D8A22C309948F94903EC210898F97912F8A3F82C38A9D2BCF5986DD86D929C61694CAC39B3FDE5994DB8A95268A0C89CC868B3ECB108983B8CA7CF722D498BED92F841EC98F97912F8A3A8FC68D9C39CF598AC096973ECB10898F80983E8A10948F909627CF0D8EC2868A6AC91586DC90902CC31C838FCB8C24CE1C958F97912F8A1786C286D90CCF158EDCC38A23C60F82DC978B23D95985C6868D23835986DCC3986AD90C85DC939C29C31C948F8C9F6ADE11828F949026CE1A86DBCFD926C312828F97912F8A3788DD97916AEB1F95C68098248A0F86DD8A9C3ED359A181C38A648A159ECD8A9A2B8422D597BEA2799C24EAA2A29729C31C89DBC3BC2DD30993C682976AD91A92C3938D3FD81CC7C085D93EC21CC7CC828D6ACD1683CB868A398A3B86DC979C3E8459B3C786D92FCB0B8BC6868A3E8A1C91C6879C24C91CC7C085D92CCF158EC1868A6ACB0AC7EA84803ADE1086C1C39D2FC30D8ECA90D929C51482DCC39F38C514C7CEC39A648A4AD69FD3D908E957EAE68DD929C51497CE919039C517C7DB8CD92EC51E9483C39A2BDE0AC7C7828F2F8A1788DBC38C24CE1C95C88C972F8A1486C58C8B6AC91186C1849C398A1D92DD8A972D8A0D8FCAC39D25C71C94DB8A9A2BDE1088C1C38938C51A82DC90D56ACB0AC7DB8B9C6ACC1695C2C39824CE5985CA8B983CC316958F8C9F6ADE11828F879627CF0A93C680D929CB0DC7C690D924C50DC7DD829D23C9188BC39AD92EC31F81CA919C24DE5981DD8C946ADE1188DC86D925CC5990C68F9D29CB0D948F82972E8A1D88C2868A3EC31AC7CC828D398A1895CAC3892FD81F82CC9795338A1A86DF829B26CF5988C9C38A3FD80F8ED98A972D8A10898F97912F8A0E8EC387D7119941BAF4D0C0178A3F92C38F806ACE168ACA908D23C91893CA87D922C50C94CAC39A2BDE0AC7C0858D2FC4598EC1979C38C80B82CA87D93DC30D8F8F859C38CB15C7E9CDD929CB0D92DCC38925DA0C8BCE979025C40ACBF4D7C9178A0995C0878C29C317808F8B8028D81083DCC38A3FC911C7CE90D93EC21CC7E4869526CB0AC7CC828D648A2D8FC690D926C3148EDB869D6ACF0F88C3968D23C517C7CB968B23C41EC7CB8C942FD90D8ECC828D23C517C7C2869824D95993C7828D6AC20085DD8A9D23D91893C68C976AC918898F8C9A29DF0BC7D88A8D228A1486C19AD925DE1182DDC39F2FC61083DCCFD924C50D86CD8F806ADE11828FA28A23CB17C7C386963ACB0B838F80983E8422D39EBED919CF0F82DD82956AC41893DA9198268A1B82C7828F23C50B948F82972E8A1A8FCE919829DE1C95C6908D23C90AC7C085D93DC31583CC828D398A1486D6C3912BDC1CC7DF919C2EC30A97C0909C2E8A0D8FCA8ED92CC50BC7CB8C942FD90D8ECC828D23C517C7CE90D93ACF0D9481B8CA73F759B3C7868A2F8A0D95CE8A8D398A1089CC8F8C2ECF5993C78690388A0A8ACE8F956AD9109DCACFD939C51A8ECE8FD924CB0D92DD86D56AC51B91C68C8C398A1B88CB9AD926CB1780DA829E2F86598BC0959C6AC51FC7DF8F98338A1889CBC38B2FC61893C6959C26D3598FC684916AC31793CA8F9523CD1C89CC86D7119E4BBA95D2CBA82AEAD698C3AA2FDC1C95CE8FD939C7188BC3C39F2FC610838F90892FC91082DCC3942BD3598FCE959C6ACB17C7C68D9B25D817C7DB86972ECF1784D6C38D25DD1895CB90D93ECB1482C1868A398422D496BEF409CB0D948F8B983CCF5982C697912FD859868F8E8C3EDF188BC6908D23C95988DDC39A25C71482C19098268A0B82C3828D23C51794C78A896ADD1093C7C3913FC71889DCCDD91EDD16C7C28290248A0D8FCA8C8B23CF0AC7CE919C6ACD1091CA8DD92BC81692DBC39125DD5984CE978A6ADD1C95CAC39D25C71C94DB8A9A2BDE1C8381C3B0248A1689CACFD93ACF1697C386D92ECF158ECD868B2BDE1C8BD6C38D2BC71C838F80983ED9598EC1C3986ADA0B88CC868A398A16818F828B3EC31F8ECC8A98268A0A82C3869A3EC316898F828A6ADE1182D6C38E2FD81CC7DA909C2CDF15C7DF919C2ECB0D88DD90D925CC5991CA919423C457BC9BD0A46AFE118EDCC3912BD95985CA86976AC90B8EDB8A9A23D01C838F828A6AC31497C3828C39C31B8BCACFD928CF1A86DA909C6ADE11828F919C3DCB0B838F8596388A0A92CC8BD92BC45982C9859638DE598ACE9AD922CB0F828F819C2FC45993C08CD926C30D93C386C26AC91893DCC39E2FC41C95CE8F95338A1D888F8D963E8A1A86DD91806AC50C938F809627C71889CB90D92BC41DC7CE8F8D22C50C80C7C38D22CF00C7CB8CD92FCB0DC7DD8C9D2FC40D9483C3963EC21C958F90892FC91082DCC38A3FC911C7CE90D92CCF0B95CA978A6AC50BC7DB868B38C31C95DCC3942BD35985CAC39B2FDE0D82DDC3983E8A1A88C1978B25C6158EC184D93EC21C94CAC3892FD90D9481B8CB72F759B3C786D92BC60D82DD8D983EC30F828F8A9D2FCB598EDCC38D22CB0DC7CC828D398A0E82DD86D939C31497C39AD93EC51582DD828D2FCE5985D6C3892FC5098BCAC39824CE5980DD829D3FCB158BD6C39D23DC1C95C8869D6ACC0B88C2C38D22CF10958F949026CE5995CA8F983EC30F82DCC38D22D81692C88BD924CB0D92DD82956AD91C8BCA808D23C517CB8F828A6ADE1182D6C3982ECB0993CA87D93EC5598FDA8D8D23C41EC7DB8B9C6ADC1C95C28A976ACC1692C187D92BD81692C187D922DF1486C190D923C45993C09497398A1889CBC38F23C61586C8868A64F14BDFF2";

//const cipherText = "FB8B90398A10948F82D939CF1A95CA97D927CF0A94CE849C6ADE1186DBC3B06ACB14C7D891903EC317808F8E8039CF15818F819C29CB0C94CAC3903E8A1D88CA90976DDE5994CA86946ADE1690C091926ADD1093C7C38D2FD20DC7E6C39E2FDE5981DD8C946ADE11828F8A973ECF0B89CA97D76AE7189ECD86D93EC21C9E8F8B983CCF5992C1938B24DE1885C386D929C21895CE808D2FD80AC7C091D939C51482DB8B9024CD46C7E6C4946AC416938F908C38CF57C7E6C49D6AC81CC7C68D8D2FD81C94DB869D6ADE16C7C48D963D865985DA97D9038A1D88C1C48D6ADE118EC188D9038D158B8F868F2FD8598CC18C8E6ADE1186DBCFD939C559AE888F956AC21891CAC38D258A1A88C1908D38DF1A938F8E806AC50E898F909C29D81C938F80962ECF0AC7DB8CD93FD91CC7D88A8D228A149E8F858B23CF1783DCC39824CE598AD6C3963DC45997C38290248A0D82D797D93EC55992DC86D93DC21C898FAADE278A0D82DC979024CD5988DA97D93EC21694CAC39A25CE1C948F97912BDE59AE8F8E982ECF5990C697916AC700C7C991902FC41D948F849625CE5989C684913E";

// Separate the cipherText into pairs (we're assuming it's ASCII, i.e. pairs of hex digits)
cipherChars = cipherText.match(/.{1,2}/g);

const possibleKeyLengths =  [...new Array(MAXIMUM_KEY_LENGTH + 1).keys()].filter(n=>n>=MINIMUM_KEY_LENGTH);
const possibleCharacters =  [...new Array(256).keys()];
const setOfLowerCaseLetterKeyCodes = [...new Array(122 + 1).keys()].filter(n=>n>=97);

console.log(cipherChars.length + " characters of ciphertext provided. \n");
var keyLength = getKeyLength();


// To determine the correct character for each index in the key, we want to first eliminate all those characters whose
// use would result in text outside the printable ASCII range (32-127) (this is an assumption)
var key = [];
var congruentChars = [];
for(var i=0;i < keyLength;i++) {
    // Create an array of all possible characters at each index in the key
    congruentChars[i] = [];
    key[i] = possibleCharacters.slice();
}

// Create a list of all characters congruent (at the same offset % keyLength) to each other
cipherChars.forEach((c,i) =>{ congruentChars[i % keyLength].push(parseInt(c, 16)) });

congruentChars.forEach(function(observedCharacters, position){
    console.log("\nRemoving keys that would result in unprintable characters in position " + position + "...");

    // Filter out any possible keys that would result in values outside the printable ASCII range
    //console.log(key[position].length + " possible, removing those that would result in values < 32...");
    key[position] = key[position].filter((possibleValue) => {
        return observedCharacters.every(c => (c ^ possibleValue) >= 32)
    });

    //console.log(key[position].length + " possible, removing those that would result in values > 127...");

    key[position] = key[position].filter((possibleValue) => {
        return observedCharacters.every(c => (c ^ possibleValue) <= 127)
    });

    console.log('Number of possible characters at position ' + position + ' is now ' + key[position].length + ' (from 256)');

   // console.log('Checking probability distribution of remaining keys...');

    var sums = [];
    // For each possible key character at this position
    key[position].forEach(function(testChar) {
        var counters = [];
        possibleCharacters.forEach(c => counters[c] = 0);
        // Filter out characters that aren't lowercase letters
        var lowercaseCongruentLetters = observedCharacters.filter(c => setOfLowerCaseLetterKeyCodes.indexOf(c ^ testChar) !== -1);

        // Create a counter in counters[c ^ testChar] for every lowercase letter
        // i.e. counters[97] will be the count of occurrences of 'a' (97) when testChar is used as the key
        //console.log(lowercaseCongruentLetters);
        lowercaseCongruentLetters.forEach(c => typeof counters[c ^ testChar] == 'undefined' ? counters[c ^ testChar] = 1 : counters[c ^ testChar]++);

        var probabilities = counters.filter((c) => typeof c !== 'undefined').map(n => n / lowercaseCongruentLetters.length);

        sums[testChar] = probabilities.map(c=>c).reduce((m,p)=>m+(p*p), 0);
    });

    var mostLikelyOffsets = [];
    sums.forEach((s,i) => { mostLikelyOffsets.push({ i: i, sum: s }) } );

    mostLikelyOffsets = mostLikelyOffsets.sort((a,b) => a.sum - b.sum).slice(0,10);

    console.log("\nMost likely offsets for position " + position + ":");
    mostLikelyOffsets.forEach(offset => {
       console.log(offset.i + " (0x" + offset.i.toString(16).toUpperCase() +  ") (sum: " + offset.sum + ")")
    });

    key[position] = key[position].filter(c => mostLikelyOffsets.some(o => o.i == c));
});

console.log("\nOverall likely offsets table:");
console.log(key);

console.log("Press any key to enter investigation mode. 'x' to exit.")
var Wheel = function () {
    var wheel = Object.create(Wheel.prototype);
    wheel.positions = [];

    for(var i = 0; i < keyLength; i++) {
        wheel.positions[i] = 0;
    }

    wheel.getKey = function(nice) {
        var testKey = [];
        wheel.positions.forEach((rotation, i) => {
            testKey.push(key[i][rotation]);
        });
        if(nice) {
            return testKey.map(c => c.toString(16).toUpperCase()).join('-');
        } else {
            return testKey;
        }
    };

    wheel.decode = function() {
        var plaintextKeycodes = [];

        var testKey = wheel.getKey();

        cipherChars.forEach((ch, i) => {
            var c = parseInt(ch, 16);
            var k = testKey[i % testKey.length];
            plaintextKeycodes.push(c ^ k);
        });

        return plaintextKeycodes.map(k => String.fromCharCode(k)).join("");
        //return plaintextKeycodes.join(",");
    };

    return wheel;
};


var stdin = process.openStdin();
var wheel = new Wheel();
stdin.addListener("data", function(d) {
    const input = d.toString().trim();
    const inputInt = parseInt(input) - 1;

    if(inputInt >= 0 && inputInt < keyLength) {
        console.log("\n\n");

        // If this falls in the range of key lengths, treat it as an instruction to progress the "wheel" one turn
        // on the key character at this index (starting from 0)
        if(wheel.positions[inputInt] + 1 == key[inputInt].length) {
            wheel.positions[inputInt] = 0;
        } else {
            wheel.positions[inputInt]++;
        }

        console.log("Current Rotations:");
        console.log(wheel.positions.toString() + " (1-indexed; enter an index to rotate)");
        console.log(wheel.getKey(true));
        console.log(wheel.decode());
    } else if(input.toLowerCase() == "x") {
        process.exit();
    }

});

function getKeyLength() {
    const counters = [];
    var sums = {};

    possibleKeyLengths.forEach(l => {
        counters[l] = [];
        // Create a counter for every possible character
        possibleCharacters.forEach(c => counters[l][c] = 0);

        // Dunno what to call this, but the characters at the 0,N,2N positions
        var congruentChars = cipherChars.filter((c,i)=>i%l==0);

        // Count each variation
        congruentChars.forEach(c => counters[l][parseInt(c, 16)]++);

        // If the key length is N, then every Nth character of the plaintext is encrypted using the same shift.
        // If we take every Nth character and calculate frequencies, those frequencies should be in permuted order
        // If we take every Mth character and calculate frequencies, where M is not a multiple of N, those frequencies should be roughly uniform
        var totalOccurrences = counters[l].reduce((m,n)=>m+n,0);

        var probabilities = counters[l].map(n => n / totalOccurrences);

        sums[l] = probabilities.reduce((m,p)=>m+(p*p), 0);
    });

    var largestSum = { len: 0, val: 0.00 };

    console.log(sums);

    for(var s in sums)
        (sums[s] > largestSum.val) && (largestSum.val = sums[s]) && (largestSum.len = s);

    console.log("Length " + largestSum.len + " has the largest sum of squared probabilities (" + largestSum.val + ").");
    console.log("This is likely to be nonuniform, and therefore the correct key length.\n");

    return largestSum.len;
}



